<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Article androidmanifest by jackyzhougithub</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Article androidmanifest</h1>
      <h2 class="project-tagline">AndroidManifest合并原理 </h2>
      <a href="https://github.com/jackyzhougithub/article_androidManifest" class="btn">View on GitHub</a>
      <a href="https://github.com/jackyzhougithub/article_androidManifest/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/jackyzhougithub/article_androidManifest/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
<a id="1-合并冲突规则merge-conflict-rules" class="anchor" href="#1-%E5%90%88%E5%B9%B6%E5%86%B2%E7%AA%81%E8%A7%84%E5%88%99merge-conflict-rules" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 合并冲突规则（merge conflict rules）</h2>

<p>合并冲突，是指多个Manifest文件中含有同一属性但值不同时，默认合并规则解决不了从而导致的冲突。
当冲突发生时，高优先级的Manifest属性值会覆盖低优先级属性值。这个优先级规则由高到低依次是：
<code>buildType下的Manifest设置-&gt;productFlavor下的Manifest设置-&gt;主工程src/main-&gt;dependency&amp;library</code></p>

<h2>
<a id="2-合并冲突标记和选择器merge-conflict-markerselector" class="anchor" href="#2-%E5%90%88%E5%B9%B6%E5%86%B2%E7%AA%81%E6%A0%87%E8%AE%B0%E5%92%8C%E9%80%89%E6%8B%A9%E5%99%A8merge-conflict-markerselector" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 合并冲突标记和选择器（merge conflict marker&amp;selector）</h2>

<p>合并冲突标记，是android tools namespace中的一个属性，用来解决默认冲突规则解决不了的冲突。
主要包含以下几个：
    merge
    默认合并操作。
    replace
    高优先级替换低优先级Manifest文件中的属性
    strict
    属性相同而值不同时会报错，除非通过冲突规则resolved
    merge-only
    仅合并低优先级的属性
    remove
    移除指定的低优先级的属性
    remove-All
    移除相同节点类型下所有低优先级的属性</p>

<h2>
<a id="3-向androidmanifest文件注入build变量值" class="anchor" href="#3-%E5%90%91androidmanifest%E6%96%87%E4%BB%B6%E6%B3%A8%E5%85%A5build%E5%8F%98%E9%87%8F%E5%80%BC" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. 向AndroidManifest文件注入build变量值</h2>

<p>注入build变量值通常需要使用manifestPlaceholders，applicationId属性除外。另外支持部分注入，如android:authority="com.acme.${localApplicationId}.foo".
例子（1）注入applicationId
Manifest entry:
<code>&lt;activity android:name=".Main"&gt;
    &lt;intent-filter&gt;
        &lt;action android:name="${applicationId}.foo"&gt;&lt;/action&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;</code>
Gradle build file:
`android {
    compileSdkVersion 22
    buildToolsVersion "22.0.1"</p>

<pre><code>productFlavors {
    flavor1 {
        applicationId = "com.mycompany.myapplication.productFlavor1"
    }
}`
</code></pre>

<p>Merged manifest value:
<code>&lt;action android:name="com.mycompany.myapplication.productFlavor1.foo"&gt;</code></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/jackyzhougithub/article_androidManifest">Article androidmanifest</a> is maintained by <a href="https://github.com/jackyzhougithub">jackyzhougithub</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
